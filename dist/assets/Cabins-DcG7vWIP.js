import{j as e,u as j,A as N,J as D,_ as y,K as F,f as P,M as m,z as H,C as B,m as R,S as M,d as T,l as I}from"./index-HRtog5xl.js";import{S as V,T as c,I as g,M as p}from"./Menus-Dz8_vvuw.js";import{a as $,c as L,d as z}from"./Filters-DY-H6jWc.js";import{d as K,a as Q,e as _,u as W}from"./useCabins-DLHkuoJk.js";import{F as Z,a as b,I as C}from"./FormRow-CBJj4D92.js";import{F as J}from"./FileInput-CK3MJ3EI.js";import{u as O}from"./index.esm-CRrX8jkk.js";const G=j.div`
  display: flex;
  gap: 0.6rem;
  flex-direction: column;
`,U=[{name:"all",text:"All"},{name:"no-discount",text:"No discount"},{name:"discount",text:"With discount"}];function X(){return e.jsxs(G,{children:[e.jsx($,{keyValue:"discount",initialValue:"all",options:U}),e.jsx(V,{name:"sort",options:[{value:"asc-name",label:"Sort by name (A-Z)"},{value:"desc-name",label:"Sort by name (Z-A)"},{value:"asc-price",label:"Sort by price (low first)"},{value:"desc-price",label:"Sort by price (high first)"},{value:"asc-cap",label:"Sort by capacity (low first)"},{value:"desc-cap",label:"Sort by capacity (high first)"}]})]})}function Y(){const i=N(),{isPending:r,mutate:n}=D({mutationFn:s=>K(s),onSuccess:()=>{i.invalidateQueries({queryKey:["cabin"]}),y.success("Cabin deleted successfully")},onError:s=>{y.error(s.message)}});return{isLoading:r,mutate:n}}function A({isEditing:i=!1,cabinId:r}){const n=N(),{mutate:s,status:o}=D({mutationFn:i?a=>_(a,r):a=>Q(a),onSuccess:()=>{n.invalidateQueries({queryKey:["cabin"]}),y.success(`${i?"Cabin edited successfully":"Cabin successfully created!"}`)},onError:a=>y.error(a.message)});return{mutate:s,status:o}}const k=j.textarea`
  padding: 0.8rem 1.2rem;
  border: 1px solid var(--color-grey-300);
  border-radius: 5px;
  background-color: var(--color-grey-0);
  box-shadow: var(--shadow-sm);
  width: 100%;
  height: 8rem;
  max-width: 35rem;
  min-width: 20rem;
`,ee=k;function E({cabin:i={},onCloseModal:r}){const{id:n}=i,s=!!n,o=s?i:{},{register:a,handleSubmit:h,reset:x,getValues:d,formState:v}=O({defaultValues:o}),{errors:t}=v,{mutate:S,status:q}=A({isEditing:s,cabinId:n,reset:x});function w(f){S({...f,image:s?f.image:f.image[0]},{onSuccess:()=>{x(),r==null||r()}})}const u=q==="pending";function l(f){}return e.jsxs(Z,{onSubmit:h(w,l),children:[e.jsx(b,{label:"cabinName",text:"Cabin's Name",error:t==null?void 0:t.cabinName,children:e.jsx(C,{id:"cabinName",disabled:u,...a("cabinName",{required:"This field is required"})})}),e.jsx(b,{label:"capacity",text:"Maximum Capacity",error:t==null?void 0:t.maxCapacity,children:e.jsx(C,{id:"capacity",type:"number",disabled:u,...a("maxCapacity",{required:{value:!0,message:"This field is required"},min:{value:1,message:"Capacity should be atleast one"}})})}),e.jsx(b,{label:"price",text:"Regular Price",error:t==null?void 0:t.regularPrice,children:e.jsx(C,{id:"price",type:"number",disabled:u,...a("regularPrice",{required:"This field is required",min:{value:1,message:"Capacity should be atleast one"}})})}),e.jsx(b,{label:"discount",text:"Discount",error:t==null?void 0:t.discount,children:e.jsx(C,{id:"discount",type:"number",disabled:u,defaultValue:0,...a("discount",{required:"This field is required",validate:f=>+f<=d().regularPrice||"Discount should be less than price"})})}),e.jsx(b,{label:"description",text:"Description of Cabin",error:t==null?void 0:t.description,children:e.jsx(ee,{id:"description",defaultValue:"",disabled:u,...a("description",{required:"This field is required"})})}),e.jsx(b,{label:"image",text:"Cabin Photo",children:e.jsx(J,{id:"image",accept:"image/*",...a("image",{required:s?!1:"This field is required"})})}),e.jsxs(b,{children:[e.jsx(F,{variation:"secondary",type:"reset",children:"Reset"}),e.jsx(F,{disabled:u,children:s?"Edit Cabin":"Add Cabin"})]})]})}const ie=j.img`
  display: block;
  width: 10rem;
  aspect-ratio: 3/2;
  object-fit: cover;
  object-position: center;
`,se=j.div`
  color: var(--color-grey-600);
`,re=j.div`
  color: var(--color-green-700);
`,ne=j.div`
  font-weight: 300;
  font-size: 1.3rem;
  @media screen and (max-width: 768px) {
    font-size: 1.2rem;
  }
`;function ae({cabin:i}){const{cabinName:r,created_at:n,description:s,discount:o,image:a,maxCapacity:h,regularPrice:x,id:d}=i,{isLoading:v,mutate:t}=Y(),{mutate:S,status:q}=A({isEditing:!1}),w=q==="pending";function u(){S({cabinName:`copy of ${r}`,maxCapacity:h,regularPrice:x,discount:o,image:a,description:s})}return e.jsxs(c.Row,{role:"row",children:[e.jsx(g,{children:e.jsx(ie,{src:a})}),e.jsx(g,{children:e.jsx(se,{children:r})}),e.jsx(g,{children:e.jsxs(ne,{children:["Fits up to ",h," guests"]})}),e.jsx(g,{children:e.jsx("div",{children:P(x)})}),e.jsx(g,{children:o?e.jsx(re,{children:P(o)}):e.jsx("div",{children:"â€”"})}),e.jsx(g,{children:e.jsx(m,{children:e.jsxs(p.Menu,{children:[e.jsx(p.Toggle,{name:`${d}`}),e.jsxs(p.List,{name:`${d}`,children:[e.jsxs(p.Action,{onClick:()=>u(),children:[" ",e.jsx("div",{disabled:w,children:e.jsx(L,{})}),"Duplicate"]}),e.jsx(m.Button,{opens:"delete",render:l=>e.jsxs(p.Action,{onClick:()=>l(),children:[e.jsx(H,{}),"Delete"]})}),e.jsx(m.Button,{render:l=>e.jsxs(p.Action,{onClick:l,children:[e.jsx(z,{}),"Edit"]}),opens:"edit-cabin"})]}),e.jsx(m.Content,{name:"edit-cabin",render:l=>e.jsx(E,{cabin:i,onCloseModal:l})}),e.jsx(m.Content,{name:"delete",render:l=>e.jsx(B,{onClose:l,resourceName:`${r}`,onConfirm:()=>t(d),disabled:v})})]})})})]})}function te(){const{isLoading:i,error:r,cabins:n}=W(),[s]=R();if(i)return e.jsx(M,{});if(r)return e.jsx(T,{children:r.message});const o=s.get("discount"),a=s.get("sort"),h=ce(n,o),x=oe(h,a);return e.jsx(p,{children:e.jsxs(c,{columns:"130px 150px 220px 170px 170px 160px",role:"table",children:[e.jsxs(c.Header,{children:[e.jsx(c.HeaderItem,{}),e.jsx(c.HeaderItem,{children:"Cabin"}),e.jsx(c.HeaderItem,{children:"Capacity"}),e.jsx(c.HeaderItem,{children:"Price"}),e.jsx(c.HeaderItem,{children:"Discount"}),e.jsx(c.HeaderItem,{})]}),e.jsx(c.Body,{data:x,render:d=>e.jsx(ae,{cabin:d},d.id)})]})})}function ce(i,r){return!r||r==="all"?i:r==="discount"?i.filter(n=>n.discount>0):r==="no-discount"?i.filter(n=>n.discount===0):i}function oe(i,r){return r?r==="asc-name"?i.slice().sort((n,s)=>n.cabinName.localeCompare(s.cabinName)):r==="desc-name"?i.slice().sort((n,s)=>s.cabinName.localeCompare(n.cabinName)):r==="asc-price"?i.slice().sort((n,s)=>n.regularPrice-s.regularPrice):r==="desc-price"?i.slice().sort((n,s)=>s.regularPrice-n.regularPrice):r==="asc-cap"?i.slice().sort((n,s)=>n.maxCapacity-s.maxCapacity):r==="desc-cap"?i.slice().sort((n,s)=>s.maxCapacity-n.maxCapacity):i:i}const le=j.div`
  align-self: baseline;
`;function de(){return e.jsxs(m,{children:[e.jsx(le,{children:e.jsx(m.Button,{opens:"cabin-form",render:i=>e.jsx(F,{onClick:i,variation:"primary",children:"Add Cabin"})})}),e.jsx(m.Content,{name:"cabin-form",render:i=>e.jsx(E,{onCloseModal:i})})]})}function fe(){return e.jsxs(e.Fragment,{children:[e.jsxs(I,{type:"h-responsive",children:[e.jsx(T,{as:"h1",children:"All Cabins"}),e.jsx(X,{})]}),e.jsxs(I,{children:[e.jsx(te,{}),e.jsx(de,{})]})]})}export{fe as default};
